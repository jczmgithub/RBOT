function openLegend(e,a){var t,n,o;for(n=document.getElementsByClassName("tabcontent"),t=0;t<n.length;t++)n[t].style.display="none";for(o=document.getElementsByClassName("tablinks"),t=0;t<o.length;t++)o[t].className=o[t].className.replace(" active","");document.getElementById(a).style.display="block",e.currentTarget.className+=" active"}function addFila(){$.ajax({url:"/user/tablaDatos",type:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}).done(function(e){$("#tablaBody").append(e)})}function addFilaS3(e,a,t,n){$.ajax({url:"/user/tablaDatos",type:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},async:!1}).done(function(o){$filaContenido=$(o),$($filaContenido).find('select[name="selecRobot"]').val(e),$($filaContenido).find('select[name="selecMotor"]').val(a),$($filaContenido).find('input[name="pasosForm"]').val(t),$($filaContenido).find('input[name="velocidadForm"]').val(n),$("#tablaBody").append($filaContenido)})}function delFila(e){var a=e.parentNode.parentNode;a.parentNode.removeChild(a)}function delFilas(){$.ajax({url:"/user/tablaDatos",type:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}).done(function(){$("#tablaBody tr").remove()})}function playVid(){$("#videoSrc").attr("src","/video/secuencia_completa.mp4"),document.getElementById("video").load(),setTimeout(function(){document.getElementById("video").play()},4e3)}function playVidPos(e){$("#videoSrc").attr("src","/video/"+e+".mp4"),document.getElementById("video").load(),setTimeout(function(){document.getElementById("video").play()},2e3)}function playVidOrigen(){$("#videoSrc").attr("src",$("#videoSrc").attr("src").replace(".","inverso.")),document.getElementById("video").load(),setTimeout(function(){document.getElementById("video").play()},2e3)}function send(e){var a=$(e).parent().parent(),t={robot:$(a).find('select[name="selecRobot"]').val(),motor:$(a).find('select[name="selecMotor"]').val(),pasos:$(a).find('input[name="pasosForm"]').val(),velocidad:$(a).find('input[name="velocidadForm"]').val()};$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:"/domotekSend",type:"POST",dataType:"text",success:function(e){alert(e),playVidPos($(a).find('select[name="selecMotor"]').val())},error:function(e){alert("Fallo al enviar..."+e)},complete:function(e){},data:t})}function paradoEmergencia(){var e={mensaje:"Stop"};$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:"/domotekStop",type:"POST",dataType:"text",success:function(e){alert(e)},error:function(e,a,t){},complete:function(e){},data:e})}function vueltaOrigen(){var e={mensaje:"origen"};$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:"/domotekHome",type:"POST",dataType:"text",success:function(e){alert(e),playVidOrigen()},error:function(e,a,t){},complete:function(e){},data:e})}function enviarFila(e){var a={robot:$(e).find('select[name="selecRobot"]').val(),motor:$(e).find('select[name="selecMotor"]').val(),pasos:$(e).find('input[name="pasosForm"]').val(),velocidad:$(e).find('input[name="velocidadForm"]').val()};$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:"/domotekSend",type:"POST",dataType:"text",success:function(e){alert(e)},error:function(e){alert("Fallo al enviar..."+e)},complete:function(e){},data:a}),playVid()}function enviarFilas(){for(var e=$("tr"),a=1;a<e.length;a++)enviarFila(e[a]);playVid()}function guardarFila(e,a){var t={filas:e,fichero:a};$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:"/guardarFila",type:"POST",dataType:"text",success:function(e){},error:function(e,a,t){},complete:function(e){},data:t})}function guardarFilas(){for(var e=prompt("Introduce nombre de la secuencia"),a=$("tr"),t="",n=1;n<a.length;n++)t=t+";"+$(a[n]).find('select[name="selecRobot"]').val()+","+$(a[n]).find('select[name="selecMotor"]').val()+","+$(a[n]).find('input[name="pasosForm"]').val()+","+$(a[n]).find('input[name="velocidadForm"]').val(),$(a[n]).find('select[name="selecRobot"]').val();guardarFila(t,e)}function eliminarUser(e){if(confirm("Estas segur@???")){var a={email:e};$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:"/user/eliminarUser",type:"post",dataType:"text",success:function(){cargarTablaUser()},error:function(){alert("ERROR!!!")},data:a})}}function cargarTablaUser(){$.ajax({url:"/user/verUser/tablaUser",type:"get",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}).done(function(e){$("#usuarios").html(e)})}function cargarSecuncia(){$("#myModal").modal(),$("#selecSecuencia").empty(),$.ajax({url:"/listadoS3",type:"get",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}).done(function(e){$("<option/>",{text:"--Selecciona la secuencia--",disabled:"disabled",selected:"selected"}).appendTo("#selecSecuencia");for(var a=0;a<e.length;a++)$("<option/>",{text:e[a],value:e[a]}).appendTo("#selecSecuencia")})}function cargarTablaRobot(){$.ajax({url:"/user/verRobot/tablaRobot",type:"get",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}).done(function(e){$("#robots").html(e)})}function eliminarRobot(e){if(confirm("Estas segur@???")){var a={id:e};$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:"/user/eliminarRobot",type:"post",dataType:"text",success:function(){cargarTablaRobot()},error:function(){alert("ERROR!!!")},data:a})}}$(document).ready(function(){try{$("#addFilas").click(function(e){e.preventDefault(),addFila()}),$("#delFilas").click(function(e){e.preventDefault(),delFilas()}),$("#sendFilas").click(function(e){e.preventDefault(),enviarFilas()}),$("#saveSecuencia").click(function(e){e.preventDefault(),guardarFilas()}),$("#loadSecuencia").click(function(e){e.preventDefault(),cargarSecuncia()}),$("#stopRobot").click(function(e){e.preventDefault(),paradoEmergencia()}),$("#homeRobot").click(function(e){e.preventDefault(),vueltaOrigen()}),$("#selecSecuencia").on("change",function(e){var a=$("option:selected",this),t=a.val();console.log(a),console.log(t);var n={fichero:t};$.ajax({url:"/mostrarValores",type:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:n}).done(function(e){$("#tablaBody").empty();for(var a,t=e.split(";"),n=1;n<t.length;n++){console.log(t[n]),a=t[n].split(",");for(var o=new Array,r=0;r<a.length;r++)o.push(a[r]);addFilaS3(o[0],o[1],o[2],o[3])}})}),$("#tablaBody").on("click",".enviar",function(e){e.preventDefault()}),openLegend(null,"divRobot")}catch(e){}});